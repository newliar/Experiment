import os
import time
import json

osmfile = "../dataset/map.osm"
maxline = 0  # 抽样调试使用，最多转换的对象，设为0则转换文件的全部
ISOTIMEFORMAT = "%Y-%m-%d %X"
print(time.strftime(ISOTIMEFORMAT), ", Process osm XML...", osmfile, " =>MaxLine:", maxline)

fnode = open(osmfile + "_node.json", "w+")
fway = open(osmfile + "_way.json", "w+")
frelation = open(osmfile + "_relation.json", "w+")

context = etree.iterparse(osmfile, tag=["node", "way", "relation"])
fast_iter(context, process_element, maxline)

fnode.close()
fway.close()
frelation.close()

print(time.strftime(ISOTIMEFORMAT), ", OSM to JSON, Finished.")



